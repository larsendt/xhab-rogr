#------------------------------------------------------------------------------
# Main Targets
#------------------------------------------------------------------------------
all: LIBSUB 

#------------------------------------------------------------------------------
# Config
#------------------------------------------------------------------------------
OS=$(shell uname)

#------------------------------------------------------------------------------
# Compiler
#------------------------------------------------------------------------------

# C Compiler and Linker Executable
CC      := $(CROSS)gcc


#------------------------------------------------------------------------------
# Inc && Lib 
#------------------------------------------------------------------------------
LDLIB   := 

#------------------------------------------------------------------------------
# Compiler Flags 
#------------------------------------------------------------------------------
CFLAGS  := -O2 -Wall -Werror -g -I../src -I../boot/vnd/fw -I.
CFLAGS += -DLIBUSB_1_0 -I/usr/include/libusb-1.0

#------------------------------------------------------------------------------
# Linker Flags 
#------------------------------------------------------------------------------
LFLAGS  :=  -lusb-1.0 -L/lib/x86_64-linux-gnu


#------------------------------------------------------------------------------
# Common rules
#------------------------------------------------------------------------------
%.o:	%.c  
	$(CC) -fPIC -c $(CFLAGS) -o $@ $<


#------------------------------------------------------------------------------
# Target Builds
# 
#------------------------------------------------------------------------------
LIBSUB :libsub.so ###libsub.a 
libsub.a : libsub.o
	ar -rcsv $@ $^
libsub.so: libsub.o
	$(CC) -shared -Wl,-soname,$@ -o $@ libsub.o $(LFLAGS)

clean:
	@echo $(OS) Clean
	rm -f *.o *.out *.err *.exe *.a *.so

